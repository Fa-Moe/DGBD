

species<-c(rep("a",times=1000))
counts<-c(runif(n=1000,min=1,max=100))
spec_count <- transform(data.frame(species,counts)

library(vegan)
data(BCI)
BCI
abundances<-sort(colSums(BCI),decreasing = TRUE)
abundances <- t(t(unname(abundances)))

ranked_frame <- generate_rank(data_frame_abundance=abundances,column=1)
r <- ranked_frame[,"radBC_rank"]
N <- max(r)
pre_num <- N+1-r
pre_den <- r
log_num <- log(pre_num)
log_den <- log(pre_den)
lfit <- lm(log(abundances)~log_den+log_num)
summary(lfit)


head(cbind(log_den,log_num,log(abundances)))

plot(log(reffunc(1:225)),pch=16,cex=0.1,type="l")+
  points(log(abundances)~c(1:225),col="red")




reffunc<-function(orden){exp(coef(lfit)[[1]])*(dim(ranked_frame)[1]-c(orden))^coef(lfit)[[3]]*(c(orden))^coef(lfit)[[2]]}

plot(log(exp(coef(lfit)[[1]])*pre_num^coef(lfit)[3]/pre_den^-coef(lfit)[2]),pch=16,cex=0.1,type="l")+
  points(log(abundances)~c(1:225),col="red")



datos<-BC_numden(data_frame_abundance=spec_count,column="counts")
datos
rango <- generate_rank(spec_count,column=2)
max(datos)
plot(log(datos))
plot(counts~rango[,1])
plot(counts~radBC_rank,data=counted_data)





library(vegan)
data(BCI)
abundances<-unname(sort(colSums(BCI),decreasing = TRUE))
plot(abundances,log="y")
arboles<-data.frame(orden=1:length(abundances),frecuencia=abundances)
arboles_log<-data.frame(x1=log(arboles$orden),x2=log(length(arboles$frecuencia) + 1 -arboles$orden), fre=log(arboles$frecuencia))
head(arboles_log)
library(ggplot2)
ggplot(arboles, aes(x = orden, y = frecuencia)) +
  geom_point(color="red") +
  scale_y_log10() +  # Establece la escala logarÃ­tmica en el eje Y
  labs(x = "Orden", y = "Frecuencia en escala logarÃ­tmica") +
  theme_minimal()
model <- lm( fre ~ x1 + x2,  data = arboles_log)
summary(model)
